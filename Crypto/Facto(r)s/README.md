
# Cryptography: Facto\(r\)s
Author: [redtrib3](https://github.com/redtrib3)
<br>

**Points**: 600
**Hint:** : None

**Challenge description:**
```
Break RSA's Frontline.
```

#### Attachments:
rsa.txt

## Solve

The vulnerability lies in the fact that the modulus N is not long enough, making it easily factorizable.

The modulus N is 1654 bits which is considered insecure.
Factorize the modulus using online tools ([factordb](factordb.com)) .

and find p,q then find decryption key 'd' by calculating e^-1 mod phi.

Script:
```python
# pip install pycryptodome
From Crypto.Util.number import *
from factordb.factordb import FactorDB

# modulus
n=495141792216767883298396893626805512487472556997463037491007567052171627841057089675844921460137307287147034960528099688506845915981056111834407982529989176490930993028318698244358440522334998284729072279521360294147605414332733522972489521824418327420726178686552517790235525330632091214180071234123492791418888928779061689137333657379449686148265060409292327776702121160498632972093207615199170872438836727421431646608404637848715570431676928341124561306162872997948809181002194768113472749820041
# exponent
e= 65537
# ciphertext
c=136537549018363471801758465693526809535486033299428718339494160723216883973049981345793921345479956524549692642284962583908619175566848859626738895967418514182129714245928304760580443381893785221807366788135487087347585243648228805434216362736844537969072479932236179599309270237471721290244758943589830629704130611990186747551813960200068914931525308245871393636140466999316397905010344219681608288692661175163499180181150644071960094772980204160487997808517017120582545543550944267332681218441571

# using factordb api to find factors
# alternatively use factordb.com, or use requests library
def factorize_number(number) -> list:
    f = FactorDB(number)
    f.connect()
    return f.get_factor_list()
    
p,q = factorize_number(n)
phi = (p-1)*(q-1)
d = inverse(e,phi)

m = pow(c,d,n)
print(long_to_bytes(m))

```

#### Flag:
```plaintext
GLITCH{pr1m3s_f1ee_at_0nc3}
```
